<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Caps Scenario Builder: C:/egit_repositories/CAPS-Scenario-Builder/CAPS_Scenario_Builder/src/Tools/dlgaddattributes.py Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="CAPS_icon.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Caps Scenario Builder
   &#160;<span id="projectnumber">0.9</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_296f7ef44356f33aabecfab941c14354.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_a787c28094c93c8190e3ba5c1d0b2e12.html">Tools</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">dlgaddattributes.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dlgaddattributes_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespace_tools_1_1dlgaddattributes.html">00001</a> <span class="comment"># -*- coding:utf-8 -*-</span>
<a name="l00002"></a>00002 <span class="comment">#---------------------------------------------------------------------</span>
<a name="l00003"></a>00003 <span class="comment">#</span>
<a name="l00004"></a>00004 <span class="comment"># Conservation Assessment and Prioritization System (CAPS) - An Open Source  </span>
<a name="l00005"></a>00005 <span class="comment"># GIS tool to create scenarios for environmental modeling.</span>
<a name="l00006"></a>00006 <span class="comment">#</span>
<a name="l00007"></a>00007 <span class="comment">#--------------------------------------------------------------------- </span>
<a name="l00008"></a>00008 <span class="comment"># </span>
<a name="l00009"></a>00009 <span class="comment"># Copyright (C) 2011  Robert English: Daystar Computing (http://edaystar.com)</span>
<a name="l00010"></a>00010 <span class="comment">#</span>
<a name="l00011"></a>00011 <span class="comment">#---------------------------------------------------------------------</span>
<a name="l00012"></a>00012 <span class="comment"># </span>
<a name="l00013"></a>00013 <span class="comment"># licensed under the terms of GNU GPLv3</span>
<a name="l00014"></a>00014 <span class="comment"># </span>
<a name="l00015"></a>00015 <span class="comment"># This file is part of CAPS.</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="comment"># CAPS is free software: you can redistribute it and/or modify</span>
<a name="l00018"></a>00018 <span class="comment"># it under the terms of the GNU General Public License as published by</span>
<a name="l00019"></a>00019 <span class="comment"># the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00020"></a>00020 <span class="comment"># (at your option) any later version.</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment"># CAPS is distributed in the hope that it will be useful,</span>
<a name="l00023"></a>00023 <span class="comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00024"></a>00024 <span class="comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00025"></a>00025 <span class="comment"># GNU General Public License for more details.</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment"># You should have received a copy of the GNU General Public License</span>
<a name="l00028"></a>00028 <span class="comment"># along with CAPS.  If not, see &lt;http://www.gnu.org/licenses/&gt;..</span>
<a name="l00029"></a>00029 <span class="comment"># </span>
<a name="l00030"></a>00030 <span class="comment">#---------------------------------------------------------------------</span>
<a name="l00031"></a>00031 <span class="comment"># PyQt4 includes for python bindings to QT</span>
<a name="l00032"></a>00032 <span class="keyword">from</span> PyQt4 <span class="keyword">import</span> QtCore, QtGui
<a name="l00033"></a>00033 <span class="comment"># CAPS application imports</span>
<a name="l00034"></a>00034 <span class="keyword">import</span> config
<a name="l00035"></a>00035 <span class="keyword">import</span> shared
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html">00037</a> <span class="keyword">class </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html">DlgAddAttributes</a>(QtGui.QDialog):
<a name="l00038"></a>00038     <span class="stringliteral">&#39;&#39;&#39; Create the dialog to get needed attribute data from users &#39;&#39;&#39;</span>
<a name="l00039"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">00039</a>     <span class="keyword">def </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#aa09a71f386772400d0a357a43de65bb9">__init__</a>(self, mainwindow):
<a name="l00040"></a>00040         QtGui.QDialog.__init__(self, mainwindow)
<a name="l00041"></a>00041         
<a name="l00042"></a>00042         <span class="comment"># get a handle to the main window</span>
<a name="l00043"></a>00043         self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a> = mainwindow
<a name="l00044"></a>00044         <span class="comment"># get the list of Scenario Types from mainwindow</span>
<a name="l00045"></a>00045         scenarioEditTypesList = config.scenarioEditTypesList
<a name="l00046"></a>00046         <span class="comment"># get the current user-chosen scenarioEditType from mainwindow </span>
<a name="l00047"></a>00047         scenarioEditType = self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.scenarioEditType
<a name="l00048"></a>00048         
<a name="l00049"></a>00049         <span class="comment"># debugging</span>
<a name="l00050"></a>00050         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes() class initiated: scenario type is &quot;</span> + scenarioEditType
<a name="l00051"></a>00051      
<a name="l00052"></a>00052         <span class="comment"># Get the lists of field labels, combobox drop down values, and </span>
<a name="l00053"></a>00053         <span class="comment"># input field names for the current scenarioEditType.</span>
<a name="l00054"></a>00054         self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a844ddb6b4a251502a9394a4d95d51259">fieldLabels</a> = [] <span class="comment"># labels for the combo box</span>
<a name="l00055"></a>00055         self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad1623537262abd0b89d4132445a777f5">comboBoxOptions</a> = [] <span class="comment"># values in the combobox drop down menu that the user can choose</span>
<a name="l00056"></a>00056         self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad246ab079bab5c719224b99512f9bcd8">inputFieldNames</a> = [] <span class="comment"># all the field names needing input for the current scenario type</span>
<a name="l00057"></a>00057         i = 0
<a name="l00058"></a>00058         <span class="keywordflow">while</span> i &lt; len(scenarioEditTypesList):
<a name="l00059"></a>00059             <span class="keywordflow">if</span> scenarioEditTypesList[i] == scenarioEditType:
<a name="l00060"></a>00060                 self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a844ddb6b4a251502a9394a4d95d51259">fieldLabels</a> = eval(<span class="stringliteral">&quot;config.fieldLabels&quot;</span> + unicode(i))
<a name="l00061"></a>00061                 self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad1623537262abd0b89d4132445a777f5">comboBoxOptions</a> = eval(<span class="stringliteral">&quot;config.comboBoxOptions&quot;</span> + unicode(i))
<a name="l00062"></a>00062                 self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad246ab079bab5c719224b99512f9bcd8">inputFieldNames</a> = eval(<span class="stringliteral">&quot;config.inputFieldNames&quot;</span> + unicode(i))
<a name="l00063"></a>00063                 <span class="keywordflow">break</span>
<a name="l00064"></a>00064             i += 1
<a name="l00065"></a>00065         <span class="keywordflow">else</span>:
<a name="l00066"></a>00066             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes(): Scenario Edit Type not found&quot;</span>
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">#######################################################################</span>
<a name="l00069"></a>00069         <span class="stringliteral">&#39;&#39;&#39; Dynamically create the &quot;Add Attributes&quot; dialog &#39;&#39;&#39;</span>
<a name="l00070"></a>00070 <span class="comment">#######################################################################  </span>
<a name="l00071"></a>00071 
<a name="l00072"></a>00072         self.setObjectName(<span class="stringliteral">&quot;dlgAddAttributes&quot;</span>)
<a name="l00073"></a>00073         self.resize(400, 300)
<a name="l00074"></a>00074         self.gridLayout = QtGui.QGridLayout(self)
<a name="l00075"></a>00075         self.gridLayout.setObjectName(<span class="stringliteral">&quot;gridLayout&quot;</span>)
<a name="l00076"></a>00076  
<a name="l00077"></a>00077         <span class="comment"># dynamically create the field labels and input line edits</span>
<a name="l00078"></a>00078         <span class="comment"># from the labels list for the current scenario type</span>
<a name="l00079"></a>00079         self.labelWidgets = [0]*len(self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a844ddb6b4a251502a9394a4d95d51259">fieldLabels</a>)
<a name="l00080"></a>00080         self.comboBoxWidgets = [0]*len(self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a844ddb6b4a251502a9394a4d95d51259">fieldLabels</a>)
<a name="l00081"></a>00081         self.spacerItems = [0]*len(self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a844ddb6b4a251502a9394a4d95d51259">fieldLabels</a>)
<a name="l00082"></a>00082         <span class="keywordflow">for</span> c, label <span class="keywordflow">in</span> enumerate(self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a844ddb6b4a251502a9394a4d95d51259">fieldLabels</a>):
<a name="l00083"></a>00083             <span class="comment"># associate the field name with the widget names </span>
<a name="l00084"></a>00084             <span class="comment"># for easy reference to these objects</span>
<a name="l00085"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ae0af8cd186049c445cf7118046cde832">00085</a>             labelName = unicode(<span class="stringliteral">&quot;Label&quot;</span> + str(c))
<a name="l00086"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a5047067ed8b341c2c51b9598bbe659a7">00086</a>             comboBoxName = unicode(<span class="stringliteral">&quot;ComboBox&quot;</span> + str(c))
<a name="l00087"></a>00087             <span class="comment">#lineEditName = unicode(self.fieldsLabels[self.count] + &quot;LineEdit&quot;)</span>
<a name="l00088"></a>00088             
<a name="l00089"></a>00089             <span class="comment"># make each label widget          </span>
<a name="l00090"></a>00090             self.labelWidgets[c] = QtGui.QLabel(self)
<a name="l00091"></a>00091             self.labelWidgets[c].setObjectName(labelName)
<a name="l00092"></a>00092             self.labelWidgets[c].setText(label)
<a name="l00093"></a>00093             self.gridLayout.addWidget(self.labelWidgets[c], c, 0, 1, 1)
<a name="l00094"></a>00094             
<a name="l00095"></a>00095             <span class="comment"># make each combo box</span>
<a name="l00096"></a>00096             self.comboBoxWidgets[c] = QtGui.QComboBox(self)
<a name="l00097"></a>00097             <span class="comment">#self.comboBoxWidgets[c].setEditable(True)</span>
<a name="l00098"></a>00098             self.comboBoxWidgets[c].setObjectName(comboBoxName)
<a name="l00099"></a>00099             self.comboBoxWidgets[c].addItems(self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad1623537262abd0b89d4132445a777f5">comboBoxOptions</a>[c])
<a name="l00100"></a>00100             self.gridLayout.addWidget(self.comboBoxWidgets[c], c, 1, 1, 1)
<a name="l00101"></a>00101             <span class="comment">#self.lineEditName = QtGui.QLineEdit(self)</span>
<a name="l00102"></a>00102             <span class="comment">#self.lineEditName.setObjectName(lineEditName)</span>
<a name="l00103"></a>00103             <span class="comment">#self.gridLayout.addWidget(self.lineEditName, self.count, 1, 1, 1)</span>
<a name="l00104"></a>00104             
<a name="l00105"></a>00105             self.spacerItems[c] = QtGui.QSpacerItem(120, 20, QtGui.QSizePolicy.Expanding,
<a name="l00106"></a>00106                                                                 QtGui.QSizePolicy.Minimum)
<a name="l00107"></a>00107             self.gridLayout.addItem(self.spacerItems[c], c, 3, 1, 1)
<a name="l00108"></a>00108             
<a name="l00109"></a>00109             <span class="comment"># debugging</span>
<a name="l00110"></a>00110             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes(): Label Name is: &quot;</span> + labelName
<a name="l00111"></a>00111             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes(): comboBoxName is: &quot;</span> + comboBoxName
<a name="l00112"></a>00112             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes(): count is &quot;</span> + str(c)
<a name="l00113"></a>00113         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes(): The final count is + &quot;</span> + str(c)
<a name="l00114"></a>00114       
<a name="l00115"></a>00115         <span class="comment"># every scenario type change needs a description line edit input</span>
<a name="l00116"></a>00116         self.labelDescription = QtGui.QLabel(self)
<a name="l00117"></a>00117         self.labelDescription.setObjectName(<span class="stringliteral">&quot;labelDescription&quot;</span>)
<a name="l00118"></a>00118         self.labelDescription.setText(<span class="stringliteral">&quot;Description:&quot;</span>)
<a name="l00119"></a>00119         self.gridLayout.addWidget(self.labelDescription, c+1, 0, 1, 1)
<a name="l00120"></a>00120         self.lineEditDescription = QtGui.QLineEdit(self)
<a name="l00121"></a>00121         self.lineEditDescription.setObjectName(<span class="stringliteral">&quot;lineEditDescription&quot;</span>)
<a name="l00122"></a>00122         self.gridLayout.addWidget(self.lineEditDescription, c+1, 1, 1, 1)
<a name="l00123"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a43241862e3d77aa1dad8b5657cfc4be0">00123</a>         spacerItem100 = QtGui.QSpacerItem(120, 20, QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Minimum)
<a name="l00124"></a>00124         self.gridLayout.addItem(spacerItem100, c+1, 3, 1, 1)
<a name="l00125"></a>00125         <span class="comment"># finally, add the buttons and spacers for the buttons</span>
<a name="l00126"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a6e882656fb5de87908e016b883daf353">00126</a>         spacerItem200 = QtGui.QSpacerItem(20, 120, QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Expanding)
<a name="l00127"></a>00127         self.gridLayout.addItem(spacerItem200, c+2, 3, 1, 1)
<a name="l00128"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a7c1eda846882ae095e63f5d76d4b303e">00128</a>         spacerItem300 = QtGui.QSpacerItem(175, 20, QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Minimum)
<a name="l00129"></a>00129         self.gridLayout.addItem(spacerItem300, c+3, 0, 1, 2)
<a name="l00130"></a>00130         self.buttonBox = QtGui.QDialogButtonBox(self)
<a name="l00131"></a>00131         self.buttonBox.setOrientation(QtCore.Qt.Horizontal)
<a name="l00132"></a>00132         self.buttonBox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
<a name="l00133"></a>00133         self.buttonBox.setObjectName(<span class="stringliteral">&quot;buttonBox&quot;</span>)
<a name="l00134"></a>00134         self.gridLayout.addWidget(self.buttonBox, c+3, 2, 1, 2)
<a name="l00135"></a>00135         self.setWindowTitle(<span class="stringliteral">&quot;Add Attributes: &quot;</span> + scenarioEditType)
<a name="l00136"></a>00136         
<a name="l00137"></a>00137         <span class="comment"># These connections close the dialog</span>
<a name="l00138"></a>00138         QtCore.QObject.connect(self.buttonBox, QtCore.SIGNAL(<span class="stringliteral">&quot;accepted()&quot;</span>), self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#aaf6c6cff3d22fabaa91c0006c527a937">accept</a>)
<a name="l00139"></a>00139         QtCore.QObject.connect(self.buttonBox, QtCore.SIGNAL(<span class="stringliteral">&quot;rejected()&quot;</span>), self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad0ee2cafbeb9aeeafe6a784c9da47dde">reject</a>)
<a name="l00140"></a>00140         QtCore.QMetaObject.connectSlotsByName(self)
<a name="l00141"></a>00141         
<a name="l00142"></a>00142         <span class="comment"># These connections connect to the methods in this class</span>
<a name="l00143"></a>00143         QtCore.QObject.connect(self, QtCore.SIGNAL(<span class="stringliteral">&quot;accepted()&quot;</span>), self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a1d8ea34c0022cd723a6b6dfc408a2a4a">apply</a>)
<a name="l00144"></a>00144         QtCore.QObject.connect(self, QtCore.SIGNAL(<span class="stringliteral">&quot;rejected()&quot;</span>), self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a5c37f12a03f9adc00bbcf8ec4ed77bc5">cancel</a>)
<a name="l00145"></a>00145         QtCore.QMetaObject.connectSlotsByName(self)
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 <span class="comment">#######################################################################</span>
<a name="l00148"></a>00148     <span class="stringliteral">&#39;&#39;&#39; Custom Slots &#39;&#39;&#39;</span>
<a name="l00149"></a>00149 <span class="comment">#######################################################################    </span>
<a name="l00150"></a>00150     
<a name="l00151"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a1d8ea34c0022cd723a6b6dfc408a2a4a">00151</a>     <span class="keyword">def </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a1d8ea34c0022cd723a6b6dfc408a2a4a">apply</a>(self):
<a name="l00152"></a>00152         <span class="keywordflow">pass</span>
<a name="l00153"></a>00153     
<a name="l00154"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#aaf6c6cff3d22fabaa91c0006c527a937">00154</a>     <span class="keyword">def </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#aaf6c6cff3d22fabaa91c0006c527a937">accept</a>(self):
<a name="l00155"></a>00155         <span class="comment"># debugging </span>
<a name="l00156"></a>00156         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().accept()&quot;</span>
<a name="l00157"></a>00157         <span class="comment"># validation </span>
<a name="l00158"></a>00158         
<a name="l00159"></a>00159         <span class="keywordflow">for</span> widget <span class="keywordflow">in</span> self.comboBoxWidgets:
<a name="l00160"></a>00160             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().accept(): the length of comboBoxWidgets is &quot;</span> + str(len(self.comboBoxWidgets))
<a name="l00161"></a>00161             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().accept(): current text is &quot;</span> + widget.currentText()
<a name="l00162"></a>00162             <span class="keywordflow">if</span> <span class="keywordflow">not</span> widget.currentText():
<a name="l00163"></a>00163                 QtGui.QMessageBox.warning(self, <span class="stringliteral">&quot;Value Error:&quot;</span>, <span class="stringliteral">&quot;You must enter a \</span>
<a name="l00164"></a>00164 <span class="stringliteral">value for every item except the &#39;Description&#39;:&quot;</span>) 
<a name="l00165"></a>00165                 <span class="keywordflow">return</span>
<a name="l00166"></a>00166         QtGui.QDialog.accept(self)
<a name="l00167"></a>00167         
<a name="l00168"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a5c37f12a03f9adc00bbcf8ec4ed77bc5">00168</a>     <span class="keyword">def </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a5c37f12a03f9adc00bbcf8ec4ed77bc5">cancel</a>(self):
<a name="l00169"></a>00169         <span class="comment"># debugging</span>
<a name="l00170"></a>00170         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().cancel()&quot;</span>
<a name="l00171"></a>00171         
<a name="l00172"></a>00172         <span class="keywordflow">if</span> self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.toolAddLinesPolygons.rubberBand:
<a name="l00173"></a>00173             self.mainwindow.toolAddLinesPolygons.resetDraw()
<a name="l00174"></a>00174     
<a name="l00175"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad0ee2cafbeb9aeeafe6a784c9da47dde">00175</a>     <span class="keyword">def </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad0ee2cafbeb9aeeafe6a784c9da47dde">reject</a>(self):
<a name="l00176"></a>00176         <span class="comment"># debugging</span>
<a name="l00177"></a>00177         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().reject()&quot;</span>
<a name="l00178"></a>00178         
<a name="l00179"></a>00179         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.msgFlag:
<a name="l00180"></a>00180             QtGui.QDialog.reject(self)
<a name="l00181"></a>00181             <span class="keywordflow">return</span>
<a name="l00182"></a>00182 
<a name="l00183"></a>00183         <span class="keywordflow">if</span> self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.msgFlag == <span class="stringliteral">&quot;baselayer&quot;</span>:
<a name="l00184"></a>00184             title = <span class="stringliteral">&quot;Modify Features Warning&quot;</span>
<a name="l00185"></a>00185             text = <span class="stringliteral">&quot;If you click &#39;Yes&#39; in this dialog, any modifications you have made \</span>
<a name="l00186"></a>00186 <span class="stringliteral">will be lost. If you still want to modify base layer features, you will will need to start over. Do you \</span>
<a name="l00187"></a>00187 <span class="stringliteral">want to stop modifying features?&quot;</span>
<a name="l00188"></a>00188         <span class="keywordflow">elif</span> self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.msgFlag == <span class="stringliteral">&quot;userlayer&quot;</span>:
<a name="l00189"></a>00189             title = <span class="stringliteral">&quot;Paste Features Warning&quot;</span>
<a name="l00190"></a>00190             text = <span class="stringliteral">&quot;If you click &#39;Yes&#39; in this dialog, any features you have pasted \</span>
<a name="l00191"></a>00191 <span class="stringliteral">will be lost. If you still want to paste features, you will will need to start over. Do you \</span>
<a name="l00192"></a>00192 <span class="stringliteral">want to stop pasting?&quot;</span>
<a name="l00193"></a>00193         <span class="keywordflow">elif</span> self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.msgFlag == <span class="stringliteral">&quot;editlayer&quot;</span>: <span class="comment"># just for clarity</span>
<a name="l00194"></a>00194             title = <span class="stringliteral">&quot;Modify Features Warning&quot;</span>
<a name="l00195"></a>00195             text = <span class="stringliteral">&quot;If you click &#39;Yes&#39; in this dialog, any edit layer modifications you have already \</span>
<a name="l00196"></a>00196 <span class="stringliteral">made will be saved, but any remaining features you have selected will not be modified. If \</span>
<a name="l00197"></a>00197 <span class="stringliteral">you still want to modify the remaining features, you will will need to select them again and choose \</span>
<a name="l00198"></a>00198 <span class="stringliteral">&#39;Modify Features&#39;. Do you want to stop modifying features?&quot;</span>
<a name="l00199"></a>00199         reply = QtGui.QMessageBox.warning(self, title, text, 
<a name="l00200"></a>00200                                                     QtGui.QMessageBox.No|QtGui.QMessageBox.Yes)
<a name="l00201"></a>00201         
<a name="l00202"></a>00202         <span class="keywordflow">if</span> reply == QtGui.QMessageBox.No:
<a name="l00203"></a>00203             <span class="comment"># in effect cancels the &quot;Cancel&quot;</span>
<a name="l00204"></a>00204             <span class="keywordflow">return</span>
<a name="l00205"></a>00205         <span class="keywordflow">else</span>: QtGui.QDialog.reject(self) <span class="comment"># returns false to self.mainwindow.dlgAddAtts.exec_()</span>
<a name="l00206"></a>00206      
<a name="l00207"></a>00207 <span class="comment">#######################################################################</span>
<a name="l00208"></a>00208     <span class="stringliteral">&#39;&#39;&#39; Core Method &#39;&#39;&#39;</span>
<a name="l00209"></a>00209 <span class="comment">#######################################################################</span>
<a name="l00210"></a>00210 
<a name="l00211"></a><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a84a596f9fe23b1a67009e7119a9536d6">00211</a>     <span class="keyword">def </span><a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a84a596f9fe23b1a67009e7119a9536d6">getNewAttributes</a>(self, modifyFlag = False):
<a name="l00212"></a>00212         <span class="comment"># debugging</span>
<a name="l00213"></a>00213         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes()&quot;</span>
<a name="l00214"></a>00214         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): The modifyFlag is &quot;</span> + str(modifyFlag)
<a name="l00215"></a>00215         
<a name="l00216"></a>00216         geom = self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#a8e5e443d093a21bf521a41905e3536d4">mainwindow</a>.geom <span class="comment"># geometry of the active layer</span>
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="comment"># get the editFields for the current editing shapefile</span>
<a name="l00219"></a>00219         editFields = self.mainwindow.getEditFields(geom)
<a name="l00220"></a>00220         
<a name="l00221"></a>00221         <span class="comment"># debugging</span>
<a name="l00222"></a>00222         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): The editing fields are &quot;</span> + str(editFields)
<a name="l00223"></a>00223         
<a name="l00224"></a>00224         <span class="comment"># Get the field values from the &quot;Add Attributes&quot; dialog.</span>
<a name="l00225"></a>00225         <span class="comment"># note: We need to set all the field values in the editing layer,</span>
<a name="l00226"></a>00226         <span class="comment"># even those that are not used by the current scenario type change. </span>
<a name="l00227"></a>00227         a = {} <span class="comment"># Python dictionary of attributes for the current editing layer</span>
<a name="l00228"></a>00228         subListCount = 1
<a name="l00229"></a>00229         i = 0
<a name="l00230"></a>00230         <span class="keywordflow">for</span> count, field <span class="keywordflow">in</span> enumerate(editFields):
<a name="l00231"></a>00231             <span class="comment"># Fields that are in the editing shapefile but are not used for  </span>
<a name="l00232"></a>00232             <span class="comment"># the current scenario type are set to empty values here.</span>
<a name="l00233"></a>00233             <span class="keywordflow">if</span> field <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad246ab079bab5c719224b99512f9bcd8">inputFieldNames</a>:
<a name="l00234"></a>00234                 a[count] = QtCore.QVariant()
<a name="l00235"></a>00235                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): not in field names k = &quot;</span> + str(count)
<a name="l00236"></a>00236                 <span class="keywordflow">continue</span>
<a name="l00237"></a>00237             <span class="comment"># set the id field first, will be renumbered later</span>
<a name="l00238"></a>00238             <span class="keywordflow">if</span> subListCount == 1:
<a name="l00239"></a>00239                 a[count] = QtCore.QVariant(1)
<a name="l00240"></a>00240                 subListCount = 2
<a name="l00241"></a>00241                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): first field (id) k = &quot;</span> + str(count)
<a name="l00242"></a>00242                 <span class="keywordflow">continue</span>
<a name="l00243"></a>00243             <span class="comment"># if a point layer, set the altered and deleted fields</span>
<a name="l00244"></a>00244             <span class="keywordflow">if</span> geom == 0 <span class="keywordflow">and</span> subListCount == 2:
<a name="l00245"></a>00245                 <span class="keywordflow">if</span> modifyFlag: a[count] = QtCore.QVariant(<span class="stringliteral">&quot;y&quot;</span>)
<a name="l00246"></a>00246                 <span class="keywordflow">else</span>: a[count] = QtCore.QVariant(<span class="stringliteral">&quot;n&quot;</span>)
<a name="l00247"></a>00247                 subListCount = 3
<a name="l00248"></a>00248                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): second field (altered) k = &quot;</span> + str(count)
<a name="l00249"></a>00249                 <span class="keywordflow">continue</span>
<a name="l00250"></a>00250             <span class="keywordflow">if</span> geom == 0 <span class="keywordflow">and</span> subListCount == 3:
<a name="l00251"></a>00251                 a[count] = QtCore.QVariant(<span class="stringliteral">&quot;n&quot;</span>)
<a name="l00252"></a>00252                 subListCount = 4
<a name="l00253"></a>00253                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): third field (deleted) k = &quot;</span> + str(count)
<a name="l00254"></a>00254                 <span class="keywordflow">continue</span>
<a name="l00255"></a>00255             <span class="comment"># Finally, set the values for the user input fields</span>
<a name="l00256"></a>00256             <span class="comment"># Convert QStrings to unicode unless they are used immediately in a Qt method. </span>
<a name="l00257"></a>00257             <span class="comment"># This ensures that we never ask Python to slice a QString, which produces a type error.     </span>
<a name="l00258"></a>00258             <span class="keywordflow">if</span> subListCount &lt; len(self.<a class="code" href="class_tools_1_1dlgaddattributes_1_1_dlg_add_attributes.html#ad246ab079bab5c719224b99512f9bcd8">inputFieldNames</a>):
<a name="l00259"></a>00259                 text = unicode(self.comboBoxWidgets[i].currentText())
<a name="l00260"></a>00260                 <span class="comment"># returns the value associated with the option chosen by the user</span>
<a name="l00261"></a>00261                 value = text[:text.find(<span class="stringliteral">&#39;-&#39;</span>)-1]
<a name="l00262"></a>00262                 <span class="comment"># value = self.valuesDictionaryList[i].get(text)</span>
<a name="l00263"></a>00263                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): The type is &quot;</span>
<a name="l00264"></a>00264                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): is value a string? &quot;</span> + str(isinstance(value, str))
<a name="l00265"></a>00265                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): Value is &quot;</span> + value
<a name="l00266"></a>00266                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): The index for this item is &quot;</span> + str(self.comboBoxWidgets[i].currentIndex())
<a name="l00267"></a>00267                 a[count] = QtCore.QVariant(value)
<a name="l00268"></a>00268                 subListCount += 1
<a name="l00269"></a>00269                 i += 1
<a name="l00270"></a>00270                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): user input field k = &quot;</span> + str(count)
<a name="l00271"></a>00271                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): &quot;</span> + unicode(text)
<a name="l00272"></a>00272                 <span class="keywordflow">continue</span>
<a name="l00273"></a>00273             <span class="keywordflow">else</span>:
<a name="l00274"></a>00274                 <span class="comment"># this is the last field for all scenario types, the description field</span>
<a name="l00275"></a>00275                 a[count] = QtCore.QVariant(self.lineEditDescription.text())
<a name="l00276"></a>00276                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): user input field count = &quot;</span> + str(count)
<a name="l00277"></a>00277                 <span class="keywordflow">print</span> <span class="stringliteral">&quot;Tools.dlgaddattributes.DlgAddAttributes().getNewAttributes(): Description Field&quot;</span>
<a name="l00278"></a>00278         <span class="keywordflow">return</span> a
<a name="l00279"></a>00279    
<a name="l00280"></a>00280     
<a name="l00281"></a>00281             
<a name="l00282"></a>00282             
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 22 2012 18:23:06 for Caps Scenario Builder by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
